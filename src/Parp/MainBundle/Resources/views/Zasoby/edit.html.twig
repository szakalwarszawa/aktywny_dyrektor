{% extends '::base.html.twig' %}

{% block body -%}
    <div class="col-sm-12">
        <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="#general">Dane podstawowe</a></li>
            <li><a data-toggle="tab" href="#grupyad">Grupy AD</a></li>
            <li><a data-toggle="tab" href="#userzasoby">Lista Użytkowników Zasobu</a></li>
            <li><a data-toggle="tab" href="#historia">Historia wersji</a></li>
            <li><a data-toggle="tab" href="#pliki">Pliki</a></li>
        </ul>
        
        <div class="tab-content">
            <div id="general" class="tab-pane fade in active">
                <h1>Edycja Zasoby </h1>
                <div class="tabContent">
                                        <div class="btn-group">

<a class="btn btn-primary" href="{{ path('zasoby') }}">
    <i class="fa fa-list"></i> Lista Zasoby
</a>
</div>
                    {% form_theme edit_form 'bootstrap_3_horizontal_layout.html.twig' %}
                    {{ form(edit_form) }}
                </div>
            </div>            
            <div id="historia" class="tab-pane fade">
                <div  class="tabContent">
                    {{ render(controller('ParpMainBundle:Version:versions', {repository: 'Zasoby', id: edit_form.vars.value.id})) }}
                </div>
            </div>
            <div id="userzasoby" class="tab-pane fade">
                <div  class="tabContent">
                    <table class="table table-hover" id="userzasobyTable">
                        <thead>
                            <tr>
                                <th>Lp.</th>
                                <th>Nazwa użytkownika</th>
                                <th>Login do zasobu</th>
                                <th>Moduł</th>
                                <th>Poziom dostępu</th>
                                <th>Kanał dostępu</th>
                                <th>Aktywne od</th>
                                <th>Aktywne do</th>
                                <th>Powód nadania/odebrania</th>
                                <th>Wniosek</th>
                            </tr>
                        </thead>
                        {% set n = 1 %}
                        <tbody>
                            {% for row in users %}
                            {% if row.czyAktywne %}
                                <tr>
                                    <td><a href="{{ path('userzasoby_edit', {id: row.id})}}"  data-toggle="tooltip"  data-placement="top" title="costam">{{ n }}</a></td>
                                    <td><a href="{{ path('userEdit', {samaccountname: row.samaccountname})}}" 
                                   
                                    >{{ row.samaccountname  }}</a></td>
                                    <td>{{row.loginDoZasobu}}</td>
                                    <td>{{row.modul}}</td>
                                    <td>{{row.kanalDostepu}}</td>
                                    <td>{{row.poziomDostepu}}</td>
                                    <td>{{row.aktywneOd|date("Y-m-d")}}</td>
                                    <td>{{row.aktywneDo|date("Y-m-d")}}</td>
                                    <td>{{row.powodNadania}}</td>
                                    <td>
                                    {%if row.wniosek %}
                                        <a href="{{path('wnioseknadanieodebraniezasobow_show', {id: row.wniosek.id})}}">Wniosek nr {{row.wniosek.wniosek.numer}}</a>
                                    {%else%}
                                        <div class="alert alert-danger">Bez wniosku</div>
                                    {%endif%}
                                    </td>
                                    
                                    
                                </tr>
                                {% set n = n + 1 %}
                            {%endif%}
                            {% endfor %}
                        </tbody>
                        
                    </table>
                </div>
            </div>    
            <div id="grupyad" class="tab-pane fade">
                <div  class="tabContent">
                    <table class="table table-striped table-bordered" id="tableGrupyAD">
                        <tr>
                            <th>Grupa</th>
                            <th>Istnieje w AD</th>
                            <th>Użytkownicy</th>
                        </tr>
                        {% for g,p in grupyAd %}
                            <tr>
                                <td>{{g}}</td>
                                <td>{{p.exists ? "TAK" : "NIE"}} </td>
                                <td>
                                    {% for u in p.members %}
                                        {{u.name}} ,                                     
                                    {%endfor%}
                                
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>      
            <div id="pliki" class="tab-pane fade">
                <div  class="tabContent">
                    {{ render(controller('ParpMainBundle:Plik:index', {obiekt: 'Zasoby', obiektId: edit_form.vars.value.id})) }}
                </div>
            </div>
        </div>
    </div>

    
    
    
{% endblock %}

{% form_theme edit_form _self %}
{% block _parp_mainbundle_zasoby_dataZakonczeniaWdrozenia_widget %}
<div class="input-group datepicker" >
    {{ block('form_widget_simple') }}
    <span class="input-group-addon">
        <span class="fa fa-calendar"></span>
    </span>
</div>
{% endblock %} 